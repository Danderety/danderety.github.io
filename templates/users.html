<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='users.css') }}">
  <script>
    function togglePassword(id) {
      const input = document.getElementById('pw-' + id);
      input.type = input.type === 'password' ? 'text' : 'password';
    }
  </script>
</head>
<body>
  <h2>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
  <form method="post">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>–õ–æ–≥–∏–Ω</th>
          <th>–†–æ–ª—å</th>
          <th>–°—Ç–∞–ª –∞–¥–º–∏–Ω–æ–º</th>
          <th>–ê–¥–º–∏–Ω–∫–∞</th>
          <th>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</th>
          <th>–£–¥–∞–ª–∏—Ç—å</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>
            {% if u.is_superadmin %}
              üëë –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            {% elif u.is_admin %}
              üõ† –ê–¥–º–∏–Ω
            {% else %}
              üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            {% endif %}
          </td>
          <td>
            {% if u.admin_since %}
              {{ u.admin_since.strftime('%Y-%m-%d %H:%M') }}
            {% else %}
              ‚Äî
            {% endif %}
          </td>
          <td>
            {% if current_user.is_superadmin and not u.is_superadmin %}
              <input type="checkbox" name="admin_{{ u.id }}" {% if u.is_admin %}checked{% endif %}>
            {% elif u.is_superadmin %}
              ‚Äî
            {% else %}
              üîí –¢–æ–ª—å–∫–æ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            {% endif %}
          </td>
          <td>
            {% if not u.is_superadmin %}
              <input type="password" name="password_{{ u.id }}" id="pw-{{ u.id }}">
              <span class="password-toggle" onclick="togglePassword('{{ u.id }}')">üëÅ</span>
            {% else %}
              ‚Äî
            {% endif %}
          </td>
          <td>
            {% if not u.is_superadmin %}
              <input type="checkbox" name="delete_{{ u.id }}">
            {% else %}
              ‚Äî
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
  </form>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash {{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</body>
</html>
